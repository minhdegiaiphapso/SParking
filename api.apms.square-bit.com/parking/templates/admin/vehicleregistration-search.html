{% extends "admin/base.html" %}
{% block title %}
| Tìm đăng ký xe
{% endblock %}

{% block branding %}
<h1 id="site-name" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html"
    xmlns="http://www.w3.org/1999/html">
</h1>
{% endblock %}

{% block extrahead %}

<link rel="stylesheet" type="text/css" href="/static/css/page.css"/>
<link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css">
<!--datetimepicker-->
<link rel="stylesheet" type="text/css" href="/static/css/jquery.datetimepicker.css"/>
<link rel="stylesheet" type="text/css" href="/static/css/jquery.dataTables.min.css"/>
<link rel="stylesheet" type="text/css" href="/static/css/1.8.18/jquery-ui.css" media="all"/>

{% endblock %}

{% block content %}
<div class="containerRPS">

    <h2>Tìm đăng ký xe</h2>
    <form method="post" id="formRPS">
        {% csrf_token %}
        <div class="form-field">
            <label>Theo thời gian</label>

            <div>
                {% if vehicle_status_data %}
                <select name="vehicle_status" style="height: 30px; width:150px" >
                    {% for vehicle_status in vehicle_status_data %}
                        {% if vehicle_status.selected %}
                        <option name="vehicle_status" value="{{vehicle_status.value}}" selected>{{vehicle_status.name}}</option>
                        {% else %}
                        <option name="vehicle_status" value="{{vehicle_status.value}}">{{vehicle_status.name}}</option>
                        {% endif %}
                    {% endfor %}
                </select>
                {% endif %}
            </div>
        </div>

        <div class="form-field">
            <label>Từ</label>

            <div>
                <input style="height: 30px; width: 150px;" type="text" value="{{from_time}}"
                       id="datetimepicker_start" name="from_time"/>
            </div>
        </div>

        <div class="form-field">
            <label>Đến</label>

            <div>
                <input style="height: 30px; width: 150px;" type="text"
                       value='{{to_time}}'
                       id="datetimepicker_end"
                       name="to_time"/>
            </div>
        </div>

        <br style="clear:both" />

        <div class="form-field">
            <label>Biển số xe</label>

            <div>
                <input style="height: 30px; width: 150px;" type="text"
                       placeholder="Biển số xe"
                       name="vehicle_number" value="{{vehicle_number}}"/>
            </div>
        </div>

        <div class="form-field">
            <label>Tên thẻ</label>

            <div>
                <input style="height: 30px; width: 150px;" type="text"
                       placeholder="Tên thẻ"
                       id="card_label" name="card_label" value="{{card_label}}"/>
            </div>
        </div>

        <div class="form-field">
            <label>Nhãn hiệu xe</label>


            <div>
                <input style="height: 30px; width: 150px;" type="text"
                       placeholder="Nhãn hiệu xe"
                       name="vehicle_brand" value="{{vehicle_brand}}"/>
            </div>
        </div>

        <div class="form-field">
            <label>Loại xe</label>

            <div>
                {% if vehicle_type_data %}
                <select name="vehicle_type" style="height: 30px; width:150px" >
                    {% for vehicle_type in vehicle_type_data %}
                        {% if vehicle_type.selected %}
                        <option name="vehicle_type" value="{{vehicle_type.value}}" selected>{{vehicle_type.name}}</option>
                        {% else %}
                        <option name="vehicle_type" value="{{vehicle_type.value}}">{{vehicle_type.name}}</option>
                        {% endif %}
                    {% endfor %}
                </select>
                {% endif %}
            </div>
        </div>

        <br style="clear:both;"/>

        <div class="form-field">
            <label>Tên khách hàng</label>

            <div>
                <input style="height: 30px; width: 150px;" type="text"
                       placeholder="Tên khách hàng"
                       name="customer_name" value="{{customer_name}}"/>
            </div>
        </div>

        <div class="form-field">
            <label>Lái xe</label>

            <div>
                <input style="height: 30px; width: 150px;" type="text"
                       placeholder="Tên, cmnd, sđt lái xe"
                      name="driver_query" value="{{driver_query}}"/>
            </div>
        </div>

        <br style="clear:both;"/>

        <div class="form-field">
            <button class="form-field" type="submit" name="btn_SEARCH" style="text-align: center;height: 30px; width: 150px; background-color: #26C281; color: white; font-weight:bold; margin-top: 8px;">
                Tìm kiếm
            </button>
        </div>
        <div class="form-field">
            <a id="dlink"  style="display:none;"></a>
            <button class="form-field" type="submit" name="btn_EXPORT" style="text-align: center;height: 30px; width: 150px; background-color: #26C281; color: white; font-weight:bold; margin-top: 8px; margin-left:3px;">
                Xuất Excel
            </button>
        </div>
    </form>

    <br style="clear:both;"/>
    <hr/>
    <table id="datatable" style="width: 100%">
        <thead>
        <tr>
            <th>Biển số xe</th>
            <th>Tên khách hàng</th>
            <th>Tên thẻ</th>
            <th>Nhãn hiệu</th>
            <th>Loại xe</th>
            <th>Thông tin ngày giờ</th>
            <th>Trạng thái</th>
            <th>Gia hạn vé tháng</th>
        </tr>
        </thead>
        <tbody>
        {% if customer_data %}
        {% for item in customer_data %}
        <tr>
            <td>{{ item.vehicle_number }}</td>
            <td width="180px"><a href="/admin/parking/customer/{{item.customer.id}}" target='_blank' style='text-decoration:underline'>{{ item.customer.name }}</a></td>
            <td>{{ item.card_label }}</td>
            <td>{{ item.vehicle_brand }}</td>
            <td>{{ item.vehicle_type }}</td>
            <td>{{ item.datetime_info }}</td>
            <td>{{ item.vehicle_status }}</td>
            <td><a class="fa fa-money" href="/admin/parking/ticketpayment/add/?customer={{item.customer.id}}" target='_blank' style='text-decoration:underline'></a></td>
        </tr>
        {% endfor %}
        {% endif %}
        </tbody>
           </table>
</div>


<script src="/static/jquery/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
<script src="/static/jquery/jquery.min.js" type="text/javascript"></script>


<script src="/static/jquery/jquery.js"></script>
<script src="/static/jquery/jquery.dataTables.min.js"></script>

<script src="/static/jquery/jquery.min.js" type="text/javascript"></script>
<script src="/static/jquery/1.8.16/jquery-ui.min.js" type="text/javascript"></script>

<!--script for datimepicker-->
<script src="/static/jquery/jquery.js"></script>
<script src="/static/jquery/jquery.datetimepicker.js"></script>
<script>
    jQuery('#datetimepicker_start').datetimepicker({
        format:'d/m/Y',
        timepicker:false,
        lang:'vi',
        i18n:{
            vi:{
                months:[
                    'Tháng Một','Tháng Hai','Tháng Ba','Tháng Tư',
                    'Tháng Năm','Tháng Sáu','Tháng Bảy','Tháng Tám',
                    'Tháng Chín','Tháng Mười','Tháng Mười Một','Tháng Mười Hai',
                    ],
                dayOfWeek:[
                    "Chủ Nhật", "Hai", "Ba", "Tư",
                    "Năm", "Sáu", "Bảy.",
                ]
            }
        }
//        onShow:function( ct ){
//            this.setOptions({
//                maxDate:jQuery('#datetimepicker_end').val()?jQuery('#datetimepicker_end').val():false
//            })
//        }
    });
    jQuery('#datetimepicker_end').datetimepicker({
        format:'d/m/Y',
        timepicker:false,
        lang:'vi',
        i18n:{
            vi:{
                months:[
                    'Tháng Một','Tháng Hai','Tháng Ba','Tháng Tư',
                    'Tháng Năm','Tháng Sáu','Tháng Bảy','Tháng Tám',
                    'Tháng Chín','Tháng Mười','Tháng Mười Một','Tháng Mười Hai',
                    ],
                dayOfWeek:[
                    "Chủ Nhật", "Hai", "Ba", "Tư",
                    "Năm", "Sáu", "Bảy.",
                ]
            }
        },
        onShow:function( ct ){
            this.setOptions({

            })
        }
    });


</script>

<script>
    $(document).ready(function () {
        var table = $('#datatable').dataTable( {
            "order": [[0, "asc"]],
            "iDisplayLength" : 50,
            "oLanguage": {
                "sProcessing":   "Đang xử lý...",
                "sLengthMenu":   "Xem _MENU_ mục",
                "sZeroRecords":  "Không tìm thấy dòng nào phù hợp",
                "sInfo":         "Đang xem _START_ đến _END_ trong tổng số _TOTAL_ mục",
                "sInfoEmpty":    "Đang xem 0 đến 0 trong tổng số 0 mục",
                "sInfoFiltered": "(được lọc từ _MAX_ mục)",
                "sInfoPostFix":  "",
                "sSearch":       "",
                "sUrl":          "",
                "oPaginate": {
                "sFirst":    "Đầu",
                 "sPrevious": "Trước ",
                 "sNext":     " Sau",
                 "sLast":     "Cuối"
                 }
            }
        } );
    });

    var $j = jQuery.noConflict();
    $j(function() {
        $j("#card_label").autocomplete({
            source: "/admin/get_card_labels"
            });
        });
</script>

{% endblock %}
